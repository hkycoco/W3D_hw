<!DOCTYPE html>
<html>
 <head> 
  <title>Homework 7</title> 
<style>
	#container {
    float:left;
	background:pink; 
	margin:3px;
	width:60vw;
	height:60vw
}
body {
    overflow: hidden;
}
</style>
</head> 

 <body> 

<script src="js/three.min.js"></script> 
<script src="js/OrbitControls.js"></script>
<script src="js/dat.gui.min.js"></script> 
<script src="js/Stats.js"></script>



<h1 style="text-align:center"> My first game </h1>
<hr>
<div id="container">
        <canvas id="cnvs"> </canvas>
</div>
<div style="float:left; margin-left: 10px; width:32vw;">
User Name:
    <input id="user" style="width:100%" type="text" value="Mickey">
    <br/>
    <br/>
    <button id="login" style="width:100%">Login</button>
    <p id='greeting'></p>
</div>

<script>
var camera, scene, renderer, geometry, material, mesh, controls;
var pos, vel, pColor;
var clock = new THREE.Clock();
var puck;
var pointLight;

init();
animate();

function init() {

    var theCanvas = document.getElementById("cnvs");
    theCanvasFrame = document.getElementById("container");

    renderer = new THREE.WebGLRenderer({
        canvas: theCanvas,
        antialias: true
    });
    var ww = theCanvasFrame.clientWidth;
    var hh = theCanvasFrame.clientHeight;
    renderer.setSize(ww, hh);
    renderer.setClearColor(0x555555);

	scene = new THREE.Scene();

    camera = new THREE.PerspectiveCamera(50, ww/hh, 1, 1000);
    camera.position.z = 200;
    scene.add(camera);

    geometry = new THREE.BoxGeometry(220, 30, 10);
    material = new THREE.MeshBasicMaterial({
        transparent: true,
        color: 0xffffff,
        opacity: 0.4
    });

    mesh = new THREE.Mesh(geometry, material);
    mesh.position.set(0, 15, 105);
    scene.add(mesh);
    mesh2 = mesh.clone();
    mesh2.position.set(0, 15, -105);
    scene.add(mesh2);
    mesh3 = mesh.clone();
    mesh3.rotation.y = Math.PI / 2;
    mesh3.position.set(105, 15, 0);
    scene.add(mesh3);
    mesh4 = mesh.clone();
    mesh4.rotation.y = Math.PI / 2;
    mesh4.position.set(-105, 15, 0);
    scene.add(mesh4);

    pos = new THREE.Vector3(0, 1, 0);
    vel = new THREE.Vector3(50, 0, 70);
    pColor = new THREE.Color();
    pColor.setHSL(Math.random(), Math.random(), Math.random());
    puck = new THREE.Mesh(new THREE.CylinderGeometry(5, 5, 2, 20),
    new THREE.MeshBasicMaterial());
    scene.add(puck);

    pointLight = new THREE.PointLight(pColor.getHex(), 1);
    scene.add(pointLight);

    ground = new THREE.Mesh(new THREE.PlaneGeometry(200, 200, 130, 130),
    new THREE.MeshLambertMaterial({
        color: 0x888888
    }));

    ground.rotation.x = -Math.PI / 2;
    scene.add(ground);

    /*renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setClearColor(0x888888);*/

    controls = new THREE.OrbitControls(camera, renderer.domElement);
    var ambientLight = new THREE.AmbientLight(0x111111);
    scene.add(ambientLight);

    //document.body.appendChild(renderer.domElement);
}
$("#login").click(function(){
    var name = document.getElementById('user').value;
	alert(name +"is playing");
	var result = searchuser(name);
	document.getElementById('greeting').innerHTML = "welcome!";
});
function searchuser(name){
for(var i=0;i<records.length;i++)
{	
	if(record[i].name === name){
		return records[i];
	}
	return -1;
}
}

function animate() {
    var dt = clock.getDelta();
    pos.add(vel.clone().multiplyScalar(dt));

    // collision
    if (pos.x > 100) {
        pos.x = 100;
        vel.set(-vel.x, 0, vel.z);
        pColor.setHSL(Math.random(), Math.random(), Math.random() / 2 + 0.5);
    } else if (pos.x < -100) {
        pos.x = -100;
        vel.set(-vel.x, 0, vel.z);
        pColor.setHSL(Math.random(), Math.random(), Math.random() / 2 + 0.5);
    }
    if (pos.z > 100) {
        pos.z = 100;
        vel.set(vel.x, 0, -vel.z);
        pColor.setHSL(Math.random(), Math.random(), Math.random() / 2 + 0.5);
    } else if (pos.z < -100) {
        pos.z = -100;
        vel.set(vel.x, 0, -vel.z);
        pColor.setHSL(Math.random(), Math.random(), Math.random() / 2 + 0.5);
    }

    puck.position.copy(pos);
    pointLight.position.set(pos.x, 10, pos.z);
    pointLight.color = pColor;
    puck.material.color = pColor;

    controls.update();

    requestAnimationFrame(animate);
    render();
}

function render() {
    renderer.render(scene, camera);
}
</script>  
 </body>
</html>